(function(e){function t(t){for(var i,o,s=t[0],l=t[1],c=t[2],d=0,h=[];d<s.length;d++)o=s[d],a[o]&&h.push(a[o][0]),a[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);u&&u(t);while(h.length)h.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var l=n[s];0!==a[l]&&(i=!1)}i&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},a={app:0},r=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var i=n("64a9"),a=n.n(i);a.a},"0e1c":function(e,t,n){"use strict";var i=n("f04f"),a=n.n(i);a.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("2b0e"),a=n("5c96"),r=n.n(a),o=(n("0fae"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("Main")],1)}),s=[],l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"homePage"},[n("el-card",{staticClass:"card"},[n("div",{attrs:{slot:"header"},slot:"header"},[n("div",{staticClass:"card-title"},[n("span",[e._v("厂区全景图")]),n("div",{staticClass:"card-property"},[n("span",{ref:"property"})])])]),n("div",{staticClass:"card-content"},[n("div",{ref:"threeDom",staticClass:"model"}),n("div",{staticClass:"control"},[n("span",{staticClass:"control-title"},[e._v("控制台")]),n("div",{staticClass:"control-block"},[n("span",{staticClass:"control-block-title"},[e._v("是否自动旋转")]),n("el-radio-group",{on:{change:e.isSpin},model:{value:e.isRotate,callback:function(t){e.isRotate=t},expression:"isRotate"}},[n("el-radio",{attrs:{label:1}},[e._v("开启")]),n("el-radio",{attrs:{label:0}},[e._v("关闭")])],1)],1),n("div",[n("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),n("el-tree",{ref:"tree",attrs:{data:e.map,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"",props:e.defaultProps,"filter-node-method":e.filterNode},on:{"check-change":e.handleClick,check:e.handleSenceChange}})],1)])])]),n("el-dialog",{attrs:{visible:e.showDialog,title:e.title},on:{"update:visible":function(t){e.showDialog=t}}},[n("BarChart")],1)],1)},c=[],u=(n("f3e2"),n("ac4d"),n("8a81"),n("ac6a"),n("7f7f"),n("7514"),n("57e7"),n("d25f"),n("bc3a"),n("5a89")),d=(n("a5d4"),n("61d9")),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.className,style:{height:e.height,width:e.width}})},f=[],p=n("313e");n("4917"),n("4f7f"),n("5df3"),n("1c4c"),n("2caf"),n("28a5"),n("456d"),n("6d67"),n("9865"),n("78ce"),n("f576"),n("6b54"),n("87b3"),n("3b2b"),n("a481"),n("7618");function m(e,t,n){var i,a,r,o,s,l=function l(){var c=+new Date-o;c<t&&c>0?i=setTimeout(l,t-c):(i=null,n||(s=e.apply(r,a),i||(r=a=null)))};return function(){for(var a=arguments.length,c=new Array(a),u=0;u<a;u++)c[u]=arguments[u];r=this,o=+new Date;var d=n&&!i;return i||(i=setTimeout(l,t)),d&&(s=e.apply(r,c),r=c=null),s}}var b={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){var e=this;this.$_resizeHandler=m(function(){e.chart&&e.chart.resize()},100),this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},beforeDestroy:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},activated:function(){this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},deactivated:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},methods:{$_initResizeEvent:function(){window.addEventListener("resize",this.$_resizeHandler)},$_destroyResizeEvent:function(){window.removeEventListener("resize",this.$_resizeHandler)},$_sidebarResizeHandler:function(e){"width"===e.propertyName&&this.$_resizeHandler()},$_initSidebarResizeEvent:function(){this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},$_destroySidebarResizeEvent:function(){this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)}}};n("817d");var v=2e3,g={mixins:[b],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"300px"}},data:function(){return{chart:null}},mounted:function(){var e=this;this.$nextTick(function(){e.initChart()})},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=p["init"](this.$el,"macarons"),this.chart.setOption({tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:10,left:"2%",right:"2%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value",axisTick:{show:!1}}],series:[{name:"pageA",type:"bar",stack:"vistors",barWidth:"60%",data:[79,52,200,334,390,330,220],animationDuration:v},{name:"pageB",type:"bar",stack:"vistors",barWidth:"60%",data:[80,52,200,334,390,330,220],animationDuration:v},{name:"pageC",type:"bar",stack:"vistors",barWidth:"60%",data:[30,52,200,334,390,330,220],animationDuration:v}]})}}},y=g,w=n("2877"),x=Object(w["a"])(y,h,f,!1,null,null,null),_=x.exports,$=(n("53f9"),n("ae37")(u)),S={props:{msg:String},components:{BarChart:_},data:function(){return{renderer:"",scene:"",light:"",camera:"",controls:"",stats:"",mygroup:"",action:"",clock:"",mixer:"",rotateAnimate:"",isRotate:1,showDialog:!1,title:"Data",filterText:"",defaultProps:{children:"children",label:"label"},map:[{id:1,label:"Village",children:[{id:2,label:"Village frontend",children:[{id:4,label:"66#",children:[{id:5,label:"66#1",children:[{id:6,label:"home3"},{id:21,label:"home2"}]}]},{id:13,label:"Parking Lot"}]},{id:3,label:"Village Backend"}]}],pictureMap:[{sortId:1,name:"home3",location:"/img/home3.jpeg",buttons:[{buttonName:"get in",buttonLocation:[40,-20,-90],buttonType:"jump",paras:"home2"},{buttonName:"go left",buttonLocation:[-70,-20,-40],buttonType:"jump",paras:"home1"}]},{sortId:2,name:"home2",location:"/img/home2.jpeg",buttons:[{buttonName:"go back",buttonLocation:[-60,-50,-90],buttonType:"jump",paras:"home3"}]},{sortId:3,name:"home1",location:"/img/home1.jpg",buttons:[{buttonName:"go back",buttonLocation:[-60,-50,-90],buttonType:"jump",paras:"home2"}]}]}},mounted:function(){this.init()},watch:{filterText:function(e){this.$refs.tree.filter(e)}},methods:{handleClick:function(e,t,n){t&&this.$refs.tree.setCheckedNodes([e])},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},handleSenceChange:function(e,t){var n=this.pictureMap.find(function(t){return t.name===e.label});void 0!==n&&this.changeScene(e.label)},findButtonInPictureMap:function(e,t){var n=!0,i=!1,a=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var s=r.value,l=!0,c=!1,u=void 0;try{for(var d,h=s.buttons[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var f=d.value;if(f.buttonName===t)return f}}catch(p){c=!0,u=p}finally{try{l||null==h.return||h.return()}finally{if(c)throw u}}}}catch(p){i=!0,a=p}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}},init:function(){this.$refs.threeDom.addEventListener("dblclick",this.onMouseDblclick),this.rendererInit(),this.sceneInit(),this.cameraInit(),this.controlInit(),this.propertyInit(),this.modelling()},findFirst:function(e){return 1===e.sortId},modelling:function(){var e=this;this.mygroup=new u["Group"];var t=new u["TextureLoader"],n=this.pictureMap.find(this.findFirst),i=t.load("/api"+n.location),a=new u["SphereGeometry"](130,256,256),r=new u["MeshLambertMaterial"]({map:i,side:u["DoubleSide"]}),o=new u["Mesh"](a,r);o.name="球体容器",this.mygroup.add(o),n.buttons.forEach(function(t){var n=t;e.getcanvers(n.buttonName,n.buttonLocation)}),this.scene.add(this.mygroup),this.addAnimation(),this.action.paused=!0,this.refresh()},isSpin:function(e){this.action.paused=0==e},addAnimation:function(){this.clock=new u["Clock"];var e=[0,3600],t=[0,360],n=new u["KeyframeTrack"]("meshSphere.rotation[y]",e,t),i=100,a=new u["AnimationClip"]("sphereRotate",i,[n]);this.mixer=new u["AnimationMixer"](this.mygroup),this.action=this.mixer.clipAction(a),this.action.timeScale=1,this.action.setLoop(u["LoopPingPong"]).play(),this.animate()},animate:function(){this.rotateAnimate=requestAnimationFrame(this.animate),this.renderer.render(this.scene,this.camera),this.update()},update:function(){this.stats.update(),this.mixer.update(this.clock.getDelta())},rendererInit:function(){var e=1e3,t=800;this.renderer=new u["WebGLRenderer"],this.renderer.setClearColor(16777215),this.renderer.setSize(e,t),this.$refs.threeDom.appendChild(this.renderer.domElement)},sceneInit:function(){this.scene=new u["Scene"];var e=new u["AmbientLight"](4473924,3);this.scene.add(e)},cameraInit:function(){var e=800,t=800;this.camera=new u["PerspectiveCamera"](90,e/t,1,1e3),this.camera.position.set(0,0,10),this.camera.lookAt(new u["Vector3"](0,0,0))},controlInit:function(){this.controls=new $(this.camera,this.$refs.threeDom),this.controls.target.set(0,0,0),this.controls.minDistance=10,this.controls.maxPolarAngle=Math.PI,this.controls.maxDistance=30,this.controls.enablePan=!1,this.controls.addEventListener("change",this.refresh)},propertyInit:function(){this.stats=new d["Stats"],this.stats.dom.style.position="absolute",this.stats.dom.style.top="-4px",this.$refs.property.appendChild(this.stats.dom),this.stats.update()},getcanvers:function(e,t){var n=document.createElement("canvas"),i=n.getContext("2d");i.fillStyle="#FFFFFF",i.fillRect(0,0,300,200),i.translate(160,80),i.fillStyle="#000000",i.font="bold 50px 宋体",i.textBaseline="middle",i.textAlign="center",i.fillText(e,0,0);var a=new u["CanvasTexture"](n),r=new u["PlaneGeometry"](16,10,60,60),o=new u["MeshPhongMaterial"]({map:a,side:u["DoubleSide"]}),s=new u["Mesh"](r,o);return s.name=e,s.position.set(t[0],t[1],t[2]),this.mygroup.add(s),n},refresh:function(){this.renderer.render(this.scene,this.camera),this.stats.update()},onMouseDblclick:function(e){var t=this,n=this.getIntersects(e);if(0!=n.length){var i=!0,a=!1,r=void 0;try{for(var o,s=n[Symbol.iterator]();!(i=(o=s.next()).done);i=!0){var l=o.value;if(""!=l.object.name&&"球体容器"!=l.object.name){this.action.paused=!0;var c=this.findButtonInPictureMap(this.pictureMap,l.object.name);switch(c.buttonType){case"jump":this.$confirm("是否切换场景?","提示",{confirmButtonText:"切换",cancelButtonText:"取消",type:"warning"}).then(function(){t.action.paused=!0,t.changeScene(c.paras)});break}break}}}catch(u){a=!0,r=u}finally{try{i||null==s.return||s.return()}finally{if(a)throw r}}}},changeScene:function(e){var t=this,n=this.pictureMap.find(function(t){return t.name===e}),i="",a=new u["TextureLoader"];void 0!==n&&(this.removeButtons(),i=a.load("/api"+n.location),n.buttons.forEach(function(e){var n=e;t.getcanvers(n.buttonName,n.buttonLocation)}));var r=!0,o=!1,s=void 0;try{for(var l,c=this.scene.children[1].children[Symbol.iterator]();!(r=(l=c.next()).done);r=!0){var d=l.value;if("球体容器"===d.name){var h=new u["MeshLambertMaterial"]({map:i,side:u["DoubleSide"]});d.material=h}}}catch(f){o=!0,s=f}finally{try{r||null==c.return||c.return()}finally{if(o)throw s}}setTimeout(function(){t.refresh()},100)},removeButtons:function(){var e=[];e.push(this.scene.children[1].children.find(function(e){return"球体容器"===e.name})),this.scene.children[1].children=e},getIntersects:function(e){e.preventDefault();var t=new u["Raycaster"],n=new u["Vector2"],i=this.$refs.threeDom,a=i.getBoundingClientRect();n.x=(e.clientX-a.left)/i.offsetWidth*2-1,n.y=-(e.clientY-a.top)/i.offsetHeight*2+1,t.setFromCamera(n,this.camera);var r=t.intersectObjects(this.scene.children[1].children);return r}}},k=S,C=(n("0e1c"),Object(w["a"])(k,l,c,!1,null,null,null)),E=C.exports,T={name:"app",components:{Main:E}},M=T,D=(n("034f"),Object(w["a"])(M,o,s,!1,null,null,null)),z=D.exports;i["default"].use(r.a),i["default"].config.productionTip=!1,new i["default"]({render:function(e){return e(z)}}).$mount("#app")},"64a9":function(e,t,n){},f04f:function(e,t,n){}});